<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OpenRice 餐廳探索 - HTML6 UI Design</title>
  <!-- Google Fonts: Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- 頂部導航 -->
  <header>
    <div class="nav-container">
      <div class="logo">OpenRice 探索</div>
      <div class="search-filter">
        <input type="text" id="searchInput" placeholder="Search restaurant..." oninput="filterRestaurants()">
        <select id="sortBy" onchange="filterRestaurants()">
          <option value="default">Sort by..</option>
          <option value="ratingHigh">Rating: High to Low</option>
          <option value="ratingLow">Rating: Low to High</option>
        </select>
        <select id="filterRating" onchange="filterRestaurants()">
          <option value="0">All Ratings</option>
          <option value="4.0">Above 4.0</option>
          <option value="4.5">Above 4.5</option>
        </select>
        <button onclick="getRandomRecommendation()">隨機推薦</button>
      </div>
    </div>
  </header>

  <!-- Hero 區 -->
  <section class="hero">
    <h1>探索香港美食</h1>
    <p>發掘 OpenRice 上最受歡迎嘅餐廳，立即獲取你嘅美食建議！</p>
    <button onclick="scrollToSection('gridSection')">瀏覽餐廳</button>
  </section>

  <!-- 主要內容區 -->
  <main>
    <!-- 隨機推薦區 -->
    <section class="random-advice" id="randomAdviceSection">
      <h2>隨機推薦餐廳</h2>
      <p>今日唔知食咩？按下面按鈕獲取隨機建議！</p>
      <button onclick="getRandomRecommendation()">取得隨機推薦</button>
      <div class="result" id="recommendationResult" style="display:none;"></div>
    </section>

    <!-- 餐廳卡片展示區 -->
    <section id="gridSection">
      <h2 style="text-align:center; margin-bottom:20px;">餐廳目錄</h2>
      <div class="restaurant-grid" id="restaurantGrid">
        <!-- 餐廳卡片由 JavaScript 動態生成 -->
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>© 2025 OpenRice Data Scraper. All rights reserved.</p>
  </footer>

  <!-- JavaScript: 動態載入 openrice_data.json -->
  <script>
    // 由 openrice_data.json 載入餐廳資料
    let restaurants = [];

    // Demo 菜單建議語句保持不變
    const menuAdvices = [
      "試下佢哋嘅招牌燒味！",
      "享受一份精緻嘅甜品作完美收官。",
      "點個招牌海鮮拼盤，絕對正！",
      "嚐試佢哋極受歡迎嘅意大利麵。",
      "今日來點道特色咖哩飯，暖心又滿足！"
    ];

    let filteredData = [];

    // 從 openrice_data.json 讀取資料
    function loadRestaurants() {
      fetch('openrice_data.json')
        .then(response => {
          if (!response.ok) {
            throw new Error('HTTP error: ' + response.status);
          }
          return response.json();
        })
        .then(data => {
          restaurants = data;
          // 初始化篩選數據
          filteredData = [...restaurants];
          generateRestaurantCards(filteredData);
        })
        .catch(error => console.error('讀取 JSON 出錯:', error));
    }

    // 生成餐廳卡片
    function generateRestaurantCards(data) {
      const grid = document.getElementById('restaurantGrid');
      grid.innerHTML = '';
      if (data.length === 0) {
        grid.innerHTML = '<p style="text-align:center; width:100%;">無符合條件嘅餐廳</p>';
        return;
      }
      data.forEach(restaurant => {
        const card = document.createElement('div');
        card.className = 'restaurant-card';

        const header = document.createElement('header');
        header.textContent = restaurant.name;
        card.appendChild(header);

        const body = document.createElement('div');
        body.className = 'card-body';
        body.innerHTML = `
          <p><strong>菜式：</strong> ${restaurant.cuisine || ''}</p>
          <p><strong>食物類型：</strong> ${restaurant.type || ''}</p>
          <a href="#" class="btn" onclick="alert('更多資訊功能未開放'); return false;">了解詳情</a>
        `;
        card.appendChild(body);

        const footer = document.createElement('div');
        footer.className = 'card-footer';
        footer.textContent = '美食推薦';
        card.appendChild(footer);

        grid.appendChild(card);
      });
    }

    // 搜尋、排序及篩選功能
    function filterRestaurants() {
      const searchQuery = document.getElementById('searchInput').value.toLowerCase();
      const sortBy = document.getElementById('sortBy').value;
      const filterRating = parseFloat(document.getElementById('filterRating').value);

      filteredData = restaurants.filter(restaurant => {
        const matchName = restaurant.name.toLowerCase().includes(searchQuery);
        // 由於已移除 rating 字段，篩選功能需要調整
        // 如果 openrice_data.json 無 rating 字段，可以移除此篩選條件或用其他字段代替
        const matchRating = restaurant.rating ? restaurant.rating >= filterRating : true;
        return matchName && matchRating;
      });

      if (sortBy === 'ratingHigh') {
        filteredData.sort((a, b) => (b.rating || 0) - (a.rating || 0));
      } else if (sortBy === 'ratingLow') {
        filteredData.sort((a, b) => (a.rating || 0) - (b.rating || 0));
      }
      generateRestaurantCards(filteredData);
    }

    // 隨機推薦功能
    function getRandomRecommendation() {
      if (restaurants.length === 0) return;
      const randomRestaurant = restaurants[Math.floor(Math.random() * restaurants.length)];
      const randomAdvice = menuAdvices[Math.floor(Math.random() * menuAdvices.length)];
      const resultDiv = document.getElementById('recommendationResult');
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = `
        <h3 style="color:#B39DDB;">${randomRestaurant.name}</h3>
        <p><strong>菜式：</strong>${randomRestaurant.cuisine || ''}</p>
        <p><strong>食物類型：</strong>${randomRestaurant.type || ''}</p>
        <p style="margin-top:10px; font-weight:600; color:#B39DDB;">今日推薦：${randomAdvice}</p>
      `;
      resultDiv.scrollIntoView({ behavior: "smooth" });
    }

    // 滾動到指定區塊
    function scrollToSection(sectionId) {
      document.getElementById(sectionId).scrollIntoView({ behavior: "smooth" });
    }

    // 頁面初始化：載入 JSON 資料
    window.onload = function() {
      loadRestaurants();
    };
  </script>
</body>
</html>